<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - StyleHub</title>
    <style>
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-green-500: rgba(76, 175, 80, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-500: rgba(168, 75, 47, 1);
            
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-white);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-border: rgba(94, 82, 64, 0.2);
            
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            --radius-base: 8px;
            --radius-lg: 12px;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-family-base);
            background-color: var(--color-background);
            color: var(--color-text);
            line-height: 1.6;
        }
        
        /* Admin Header (No Sidebar) */
        .admin-header {
            background: var(--color-white);
            border-bottom: 1px solid var(--color-border);
            padding: var(--space-16) var(--space-24);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
        }
        
        .header-left h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--color-text);
        }
        
        .header-center {
            display: flex;
            gap: var(--space-24);
        }
        
        .nav-link {
            color: var(--color-text);
            text-decoration: none;
            font-weight: 500;
            padding: var(--space-8) var(--space-16);
            border-radius: var(--radius-base);
            transition: all 0.2s;
        }
        
        .nav-link:hover, .nav-link.active {
            background: var(--color-primary);
            color: white;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: var(--space-16);
        }
        
        .user-name {
            font-weight: 600;
        }
        
        .logout-btn {
            background: var(--color-red-500);
            color: white;
            padding: var(--space-8) var(--space-16);
            border-radius: var(--radius-base);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .logout-btn:hover {
            opacity: 0.9;
        }
        
        /* Main Content */
        .admin-content {
            padding: var(--space-32);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .login-box {
            background: white;
            padding: var(--space-32);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            width: 100%;
            max-width: 400px;
        }
        
        .form-group {
            margin-bottom: var(--space-20);
        }
        
        .form-group label {
            display: block;
            margin-bottom: var(--space-8);
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: var(--space-12);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: 14px;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--color-primary);
        }
        
        .btn {
            display: inline-block;
            padding: var(--space-12) var(--space-24);
            background: var(--color-primary);
            color: white;
            text-decoration: none;
            border-radius: var(--radius-base);
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }
        
        .btn:hover {
            background: var(--color-primary-hover);
        }
        
        .btn-large {
            padding: var(--space-16);
            font-size: 16px;
            width: 100%;
        }
        
        .btn-secondary {
            background: var(--color-gray-300);
            color: var(--color-text);
        }
        
        .btn-secondary:hover {
            background: var(--color-gray-400);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-24);
            margin-bottom: var(--space-32);
        }
        
        .stat-card {
            background: white;
            padding: var(--space-24);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: var(--space-8);
        }
        
        .stat-label {
            color: var(--color-text-secondary);
            font-size: 14px;
        }
        
        /* Data Table */
        .data-table {
            width: 100%;
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .data-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: var(--color-gray-200);
            padding: var(--space-16);
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }
        
        .data-table td {
            padding: var(--space-16);
            border-bottom: 1px solid var(--color-border);
            font-size: 14px;
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        .data-table img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: var(--radius-base);
        }
        
        /* Image Upload */
        .image-upload-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-16);
            margin-bottom: var(--space-20);
        }
        
        .image-upload-item {
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-base);
            padding: var(--space-16);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--color-surface);
        }
        
        .image-upload-item:hover {
            border-color: var(--color-primary);
            background: rgba(33, 128, 141, 0.05);
        }
        
        .image-upload-item h4 {
            font-size: 14px;
            margin-bottom: var(--space-8);
            font-weight: 600;
        }
        
        .image-preview {
            margin-top: var(--space-12);
            position: relative;
            display: inline-block;
        }
        
        .image-preview img {
            max-width: 150px;
            max-height: 150px;
            border-radius: var(--radius-base);
            object-fit: cover;
        }
        
        .image-preview-remove {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--color-red-500);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            padding: var(--space-32);
            border-radius: var(--radius-lg);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-24);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--color-text-secondary);
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--color-slate-900);
            color: white;
            padding: 16px 24px;
            border-radius: var(--radius-base);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 3000;
            animation: slideIn 0.3s ease-out;
            min-width: 250px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .toast.success {
            background: var(--color-green-500);
        }
        
        .toast.error {
            background: var(--color-red-500);
        }
        
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Status Badges */
        .status-badge {
            padding: var(--space-8) var(--space-12);
            border-radius: var(--radius-base);
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-processing {
            background: #cfe2ff;
            color: #084298;
        }
        
        .status-shipped {
            background: #d1e7dd;
            color: #0f5132;
        }
        
        .status-delivered {
            background: #d1e7dd;
            color: #0f5132;
        }
        
        .action-btn {
            padding: var(--space-8) var(--space-12);
            margin: 0 var(--space-8);
            border: none;
            border-radius: var(--radius-base);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }
        
        .btn-edit {
            background: #0dcaf0;
            color: white;
        }
        
        .btn-delete {
            background: #dc3545;
            color: white;
        }
        
        .hidden {
            display: none !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mb-16 { margin-bottom: var(--space-16); }
        .mb-24 { margin-bottom: var(--space-24); }
        
        /* Size checkboxes */
        .size-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-12);
        }
        
        .size-checkboxes label {
            display: flex;
            align-items: center;
            gap: var(--space-8);
            font-weight: normal;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-center {
                display: none;
            }
            
            .image-upload-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const CONFIG = {
            API_BASE_URL: "https://script.google.com/macros/s/AKfycbzS80b6r7B8DuqJ-Xhb1hg8TDoOK5R5NCC6YTJ7hGgvQ_k9tBiMoLeKnxgT7smcfIOu/exec",
            ADMIN_USERNAME: "admin",
            ADMIN_PASSWORD: "admin123",
            SESSION_TIMEOUT: 3600000 // 1 hour in milliseconds
        };

        // ============================================
        // STATE MANAGEMENT
        // ============================================
        let appState = {
            isLoggedIn: false,
            currentPage: 'login',
            products: [],
            orders: [],
            sessionStart: null
        };

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function formatCurrency(amount) {
            return 'Rp ' + amount.toLocaleString('id-ID');
        }

        function checkSession() {
            if (appState.isLoggedIn && appState.sessionStart) {
                const elapsed = Date.now() - appState.sessionStart;
                if (elapsed > CONFIG.SESSION_TIMEOUT) {
                    logout();
                    showToast('Session expired. Please login again.', 'error');
                    return false;
                }
            }
            return appState.isLoggedIn;
        }

        // ============================================
        // AUTHENTICATION
        // ============================================
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === CONFIG.ADMIN_USERNAME && password === CONFIG.ADMIN_PASSWORD) {
                appState.isLoggedIn = true;
                appState.sessionStart = Date.now();
                showToast('‚úÖ Login successful!');
                navigateTo('dashboard');
            } else {
                showToast('‚ùå Invalid credentials', 'error');
            }
        }

        function logout() {
            appState.isLoggedIn = false;
            appState.sessionStart = null;
            navigateTo('login');
            showToast('Logged out successfully');
        }

        // ============================================
        // NAVIGATION
        // ============================================
        function navigateTo(page) {
            if (page !== 'login' && !checkSession()) {
                navigateTo('login');
                return;
            }
            
            appState.currentPage = page;
            render();
        }

        // ============================================
        // RENDER FUNCTIONS
        // ============================================
        function render() {
            const app = document.getElementById('app');
            
            if (!appState.isLoggedIn) {
                app.innerHTML = renderLoginPage();
                return;
            }
            
            switch(appState.currentPage) {
                case 'dashboard':
                    app.innerHTML = renderDashboard();
                    break;
                case 'products':
                    app.innerHTML = renderProducts();
                    break;
                case 'orders':
                    app.innerHTML = renderOrders();
                    break;
                case 'inventory':
                    app.innerHTML = renderInventory();
                    break;
                case 'settings':
                    app.innerHTML = renderSettings();
                    break;
                default:
                    app.innerHTML = renderDashboard();
            }
        }

        function renderLoginPage() {
            return `
                <div class="login-container">
                    <div class="login-box">
                        <h1 class="text-center mb-24">üîê Admin Login</h1>
                        <p class="text-center mb-24" style="color: var(--color-text-secondary);">StyleHub Admin Dashboard</p>
                        <form onsubmit="handleLogin(event)">
                            <div class="form-group">
                                <label>Username</label>
                                <input type="text" id="username" required>
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" id="password" required>
                            </div>
                            <button type="submit" class="btn btn-large">Login</button>
                            <p class="text-center" style="margin-top: 16px; color: var(--color-text-secondary); font-size: 12px;">
                                Demo: admin / admin123
                            </p>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderHeader() {
            return `
                <header class="admin-header">
                    <div class="header-left">
                        <h1>üìä Admin Dashboard</h1>
                    </div>
                    <div class="header-center">
                        <a href="#" onclick="navigateTo('dashboard'); return false;" class="nav-link ${appState.currentPage === 'dashboard' ? 'active' : ''}">Dashboard</a>
                        <a href="#" onclick="navigateTo('products'); return false;" class="nav-link ${appState.currentPage === 'products' ? 'active' : ''}">Products</a>
                        <a href="#" onclick="navigateTo('orders'); return false;" class="nav-link ${appState.currentPage === 'orders' ? 'active' : ''}">Orders</a>
                        <a href="#" onclick="navigateTo('inventory'); return false;" class="nav-link ${appState.currentPage === 'inventory' ? 'active' : ''}">Inventory</a>
                        <a href="#" onclick="navigateTo('settings'); return false;" class="nav-link ${appState.currentPage === 'settings' ? 'active' : ''}">Settings</a>
                    </div>
                    <div class="header-right">
                        <span class="user-name">üë§ Admin</span>
                        <a href="#" onclick="logout(); return false;" class="logout-btn">Logout</a>
                    </div>
                </header>
            `;
        }

        function renderDashboard() {
            const totalProducts = appState.products.length;
            const totalOrders = appState.orders.length;
            const totalRevenue = appState.orders.reduce((sum, order) => sum + (order.total || 0), 0);
            const ordersToday = appState.orders.filter(o => o.date === new Date().toISOString().split('T')[0]).length;
            const lowStockItems = appState.products.filter(p => p.stock < 5).length;
            
            return `
                ${renderHeader()}
                <main class="admin-content">
                    <h1 class="mb-24">Dashboard Overview</h1>
                    
                    <div class="stats-grid">
                        <div class="stat-card" style="border-left: 4px solid #667eea;">
                            <div class="stat-value" style="color: #667eea;">${totalProducts}</div>
                            <div class="stat-label">Total Products</div>
                        </div>
                        <div class="stat-card" style="border-left: 4px solid #4CAF50;">
                            <div class="stat-value" style="color: #4CAF50;">${totalOrders}</div>
                            <div class="stat-label">Total Orders</div>
                        </div>
                        <div class="stat-card" style="border-left: 4px solid #FF9800;">
                            <div class="stat-value" style="color: #FF9800; font-size: 20px;">${formatCurrency(totalRevenue)}</div>
                            <div class="stat-label">Total Revenue</div>
                        </div>
                        <div class="stat-card" style="border-left: 4px solid #2196F3;">
                            <div class="stat-value" style="color: #2196F3;">${ordersToday}</div>
                            <div class="stat-label">Orders Today</div>
                        </div>
                        <div class="stat-card" style="border-left: 4px solid #FF5722;">
                            <div class="stat-value" style="color: #FF5722;">${lowStockItems}</div>
                            <div class="stat-label">Low Stock Items</div>
                        </div>
                    </div>
                    
                    <div style="background: ${CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID') ? 'linear-gradient(135deg, #f44336 0%, #e91e63 100%)' : 'linear-gradient(135deg, #4caf50 0%, #8bc34a 100%)'}; padding: 24px; border-radius: 12px; margin-bottom: 24px; color: white; box-shadow: var(--shadow-md);">
                        <h3 style="color: white; margin-bottom: 16px;">${CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID') ? '‚ö†Ô∏è API Not Configured' : '‚úÖ Google Sheets Connected'}</h3>
                        <div style="display: grid; gap: 12px;">
                            <div>
                                <p style="font-size: 12px; opacity: 0.9; margin-bottom: 4px;">Current API Endpoint:</p>
                                <p style="font-family: monospace; font-size: 11px; background: rgba(255,255,255,0.2); padding: 8px; border-radius: 4px; word-break: break-all;">${CONFIG.API_BASE_URL}</p>
                            </div>
                            ${CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID') ? `
                            <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 6px;">
                                <strong>üîß Action Required:</strong><br>
                                <p style="margin-top: 8px; font-size: 13px;">The dashboard is working in LOCAL MODE. Data will be saved in browser memory only and will be lost on refresh.</p>
                                <p style="margin-top: 8px; font-size: 13px;">To enable Google Sheets sync, update the CONFIG.API_BASE_URL in the code.</p>
                            </div>
                            ` : `
                            <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 6px;">
                                <strong>‚úÖ Connected:</strong><br>
                                <p style="margin-top: 8px; font-size: 13px;">Your products and orders are being synced with Google Sheets.</p>
                                <button class="btn" onclick="loadProductsFromAPI()" style="margin-top: 12px; background: white; color: #4caf50;">üîÑ Sync from Sheets</button>
                            </div>
                            `}
                        </div>
                        <div style="margin-top: 16px; padding: 12px; background: rgba(255,255,255,0.15); border-radius: 6px; font-size: 12px; line-height: 1.6;">
                            <strong>üí° Quick Setup Guide:</strong><br>
                            1. Create Google Sheet with "Products" and "Orders" tabs<br>
                            2. Extensions ‚Üí Apps Script ‚Üí Create doGet() and doPost() handlers<br>
                            3. Deploy as web app (Anyone can access)<br>
                            4. Update CONFIG.API_BASE_URL with deployment URL<br>
                            5. Refresh dashboard - products will sync automatically!
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 24px; border-radius: 12px;">
                        <h3 class="mb-16">Recent Orders</h3>
                        ${appState.orders.length === 0 ? '<p>No orders yet</p>' : `
                            <div class="data-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Order ID</th>
                                            <th>Customer</th>
                                            <th>Total</th>
                                            <th>Status</th>
                                            <th>Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${appState.orders.slice(-5).reverse().map(order => `
                                            <tr>
                                                <td>${order.id}</td>
                                                <td>${order.customerName}</td>
                                                <td>${formatCurrency(order.total)}</td>
                                                <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                                                <td>${order.date}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        `}
                    </div>
                </main>
            `;
        }

        function renderProducts() {
            return `
                ${renderHeader()}
                <main class="admin-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <h1>Products Management</h1>
                        <button class="btn" onclick="openAddProductModal()">‚ûï Add Product</button>
                    </div>
                    
                    ${appState.products.length === 0 ? `
                        <div style="background: white; padding: 60px 24px; border-radius: 12px; text-align: center;">
                            <p style="font-size: 48px; margin-bottom: 16px;">üì¶</p>
                            <p style="margin-bottom: 24px;">No products added yet</p>
                            <button class="btn" onclick="openAddProductModal()">Add Your First Product</button>
                        </div>
                    ` : `
                        <div class="data-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Images</th>
                                        <th>Name</th>
                                        <th>Category</th>
                                        <th>Price</th>
                                        <th>Stock</th>
                                        <th>Rating</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${appState.products.map((product, index) => `
                                        <tr>
                                            <td>
                                                <div style="display: flex; gap: 4px;">
                                                    ${product.imageFront ? `<img src="${product.imageFront}" alt="Front">` : ''}
                                                    ${product.imageBack ? `<img src="${product.imageBack}" alt="Back" style="width: 30px; height: 30px;">` : ''}
                                                </div>
                                            </td>
                                            <td>${product.name}</td>
                                            <td>${product.category}</td>
                                            <td>${formatCurrency(product.price)}</td>
                                            <td>${product.stock}</td>
                                            <td>‚≠ê ${product.rating || 0}</td>
                                            <td>
                                                <button class="action-btn btn-edit" onclick="editProduct(${index})">Edit</button>
                                                <button class="action-btn btn-delete" onclick="deleteProduct(${index})">Delete</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `}
                </main>
                
                <div class="modal" id="productModal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 id="modalTitle">Add Product</h2>
                            <button class="close-modal" onclick="closeProductModal()">√ó</button>
                        </div>
                        <form id="productForm" onsubmit="saveProduct(event)">
                            <div class="form-group">
                                <label>Product Name *</label>
                                <input type="text" id="productName" required>
                            </div>
                            <div class="form-group">
                                <label>Description *</label>
                                <textarea id="productDescription" rows="3" required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Category *</label>
                                <select id="productCategory" required>
                                    <option value="T-Shirt">T-Shirt</option>
                                    <option value="Jacket">Jacket</option>
                                    <option value="Shirt">Shirt</option>
                                    <option value="Pants">Pants</option>
                                    <option value="Shoes">Shoes</option>
                                    <option value="Accessories">Accessories</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Price *</label>
                                <input type="number" id="productPrice" required>
                            </div>
                            <div class="form-group">
                                <label>Original Price</label>
                                <input type="number" id="productOriginalPrice">
                            </div>
                            <div class="form-group">
                                <label>Stock Quantity *</label>
                                <input type="number" id="productStock" required>
                            </div>
                            
                            <h3 class="mb-16">Product Images</h3>
                            <div class="image-upload-grid">
                                <div class="image-upload-item" onclick="document.getElementById('imageFront').click()">
                                    <h4>üì∏ Front View</h4>
                                    <input type="file" id="imageFront" accept="image/*" style="display: none;" onchange="handleImageUpload(event, 'front')">
                                    <p style="font-size: 12px; color: var(--color-text-secondary);">Click to upload</p>
                                    <div id="previewFront"></div>
                                </div>
                                <div class="image-upload-item" onclick="document.getElementById('imageBack').click()">
                                    <h4>üì∏ Back View</h4>
                                    <input type="file" id="imageBack" accept="image/*" style="display: none;" onchange="handleImageUpload(event, 'back')">
                                    <p style="font-size: 12px; color: var(--color-text-secondary);">Click to upload</p>
                                    <div id="previewBack"></div>
                                </div>
                                <div class="image-upload-item" onclick="document.getElementById('imageSide').click()">
                                    <h4>üì∏ Side View</h4>
                                    <input type="file" id="imageSide" accept="image/*" style="display: none;" onchange="handleImageUpload(event, 'side')">
                                    <p style="font-size: 12px; color: var(--color-text-secondary);">Click to upload</p>
                                    <div id="previewSide"></div>
                                </div>
                                <div class="image-upload-item" onclick="document.getElementById('imageTop').click()">
                                    <h4>üì∏ Top View</h4>
                                    <input type="file" id="imageTop" accept="image/*" style="display: none;" onchange="handleImageUpload(event, 'top')">
                                    <p style="font-size: 12px; color: var(--color-text-secondary);">Click to upload</p>
                                    <div id="previewTop"></div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Available Sizes</label>
                                <div class="size-checkboxes">
                                    <label><input type="checkbox" name="sizes" value="XS"> XS</label>
                                    <label><input type="checkbox" name="sizes" value="S"> S</label>
                                    <label><input type="checkbox" name="sizes" value="M"> M</label>
                                    <label><input type="checkbox" name="sizes" value="L"> L</label>
                                    <label><input type="checkbox" name="sizes" value="XL"> XL</label>
                                    <label><input type="checkbox" name="sizes" value="2XL"> 2XL</label>
                                    <label><input type="checkbox" name="sizes" value="3XL"> 3XL</label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Rating (0-5)</label>
                                <input type="number" id="productRating" min="0" max="5" step="0.1" value="4.5">
                            </div>
                            
                            <input type="hidden" id="productIndex">
                            <button type="submit" class="btn btn-large">Save Product</button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderOrders() {
            return `
                ${renderHeader()}
                <main class="admin-content">
                    <h1 class="mb-24">Orders Management</h1>
                    
                    ${appState.orders.length === 0 ? `
                        <div style="background: white; padding: 60px 24px; border-radius: 12px; text-align: center;">
                            <p style="font-size: 48px; margin-bottom: 16px;">üõí</p>
                            <p>No orders yet</p>
                        </div>
                    ` : `
                        <div class="data-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Customer</th>
                                        <th>Email</th>
                                        <th>Amount</th>
                                        <th>Items</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${appState.orders.map((order, index) => `
                                        <tr>
                                            <td>${order.id}</td>
                                            <td>${order.customerName}</td>
                                            <td>${order.customerEmail}</td>
                                            <td>${formatCurrency(order.total)}</td>
                                            <td>${order.items?.length || 0}</td>
                                            <td>
                                                <select class="status-badge status-${order.status}" onchange="updateOrderStatus(${index}, this.value)">
                                                    <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
                                                    <option value="processing" ${order.status === 'processing' ? 'selected' : ''}>Processing</option>
                                                    <option value="shipped" ${order.status === 'shipped' ? 'selected' : ''}>Shipped</option>
                                                    <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Delivered</option>
                                                </select>
                                            </td>
                                            <td>${order.date}</td>
                                            <td>
                                                <button class="action-btn btn-edit" onclick="viewOrderDetails(${index})">View</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `}
                </main>
            `;
        }

        function renderInventory() {
            const lowStockProducts = appState.products.filter(p => p.stock < 5);
            
            return `
                ${renderHeader()}
                <main class="admin-content">
                    <h1 class="mb-24">Inventory Management</h1>
                    
                    ${lowStockProducts.length > 0 ? `
                        <div style="background: #fff3cd; padding: 16px; border-radius: 8px; margin-bottom: 24px; border: 1px solid #856404;">
                            <strong>‚ö†Ô∏è Low Stock Alert:</strong> ${lowStockProducts.length} product(s) have low stock (less than 5 units)
                        </div>
                    ` : ''}
                    
                    ${appState.products.length === 0 ? `
                        <div style="background: white; padding: 60px 24px; border-radius: 12px; text-align: center;">
                            <p>No products in inventory</p>
                        </div>
                    ` : `
                        <div class="data-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Category</th>
                                        <th>Current Stock</th>
                                        <th>Low Stock Alert</th>
                                        <th>Edit</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${appState.products.map((product, index) => `
                                        <tr style="${product.stock < 5 ? 'background: #fff3cd;' : ''}">
                                            <td>${product.name}</td>
                                            <td>${product.category}</td>
                                            <td>${product.stock}</td>
                                            <td>
                                                <span class="status-badge ${product.stock > 10 ? 'status-delivered' : product.stock > 0 ? 'status-pending' : 'status-processing'}">
                                                    ${product.stock > 10 ? '‚úÖ In Stock' : product.stock > 0 ? '‚ö†Ô∏è Low Stock' : '‚ùå Out of Stock'}
                                                </span>
                                            </td>
                                            <td>
                                                <button class="action-btn btn-edit" onclick="updateStock(${index})">Update Stock</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `}
                </main>
            `;
        }

        function renderSettings() {
            return `
                ${renderHeader()}
                <main class="admin-content">
                    <h1 class="mb-24">Settings &amp; Configuration</h1>
                    
                    <div style="background: white; padding: 32px; border-radius: 12px; margin-bottom: 24px;">
                        <h3 class="mb-16">üîß API Configuration</h3>
                        <p style="color: var(--color-text-secondary); margin-bottom: 24px;">Configure your Google Sheets integration</p>
                        
                        <div class="form-group">
                            <label>Google Apps Script API URL</label>
                            <input type="text" value="${CONFIG.API_BASE_URL}" readonly style="background: var(--color-gray-200);">
                            <p style="font-size: 12px; color: var(--color-text-secondary); margin-top: 8px;">
                                Update this in the CONFIG object at the top of the HTML file
                            </p>
                        </div>
                        
                        <div class="form-group">
                            <label>Test API Connection</label>
                            <button class="btn" onclick="testAPIConnection()">üîå Test Connection</button>
                            <div id="apiTestResult" style="margin-top: 12px;"></div>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 32px; border-radius: 12px; margin-bottom: 24px;">
                        <h3 class="mb-16">üîê Admin Credentials</h3>
                        
                        <div class="form-group">
                            <label>Username</label>
                            <input type="text" value="${CONFIG.ADMIN_USERNAME}" readonly style="background: var(--color-gray-200);">
                        </div>
                        
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" value="${CONFIG.ADMIN_PASSWORD}" readonly style="background: var(--color-gray-200);">
                        </div>
                        
                        <p style="font-size: 12px; color: var(--color-text-secondary);">
                            Change these in the CONFIG object for security
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 24px; border-radius: 12px; color: white;">
                        <h3 style="color: white; margin-bottom: 12px;">üí° Google Sheets Setup</h3>
                        <ol style="margin-left: 20px; line-height: 1.8;">
                            <li>Create a new Google Sheet with two tabs: "Products" and "Orders"</li>
                            <li>Go to Extensions &gt; Apps Script</li>
                            <li>Create API endpoints for GET and POST requests</li>
                            <li>Deploy as Web App (Execute as: Me, Who has access: Anyone)</li>
                            <li>Copy deployment URL and update CONFIG.API_BASE_URL</li>
                            <li>Products will be saved to Google Sheets and persist across refreshes</li>
                        </ol>
                    </div>
                </main>
            `;
        }

        // ============================================
        // PRODUCT MANAGEMENT
        // ============================================
        let uploadedImages = {
            front: null,
            back: null,
            side: null,
            top: null
        };

        function openAddProductModal() {
            document.getElementById('productModal').classList.add('active');
            document.getElementById('modalTitle').textContent = 'Add Product';
            document.getElementById('productForm').reset();
            document.getElementById('productIndex').value = '';
            uploadedImages = { front: null, back: null, side: null, top: null };
            clearImagePreviews();
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
        }

        function handleImageUpload(event, viewType) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showToast('Image size must be less than 5MB', 'error');
                return;
            }
            
            if (!file.type.startsWith('image/')) {
                showToast('Please select a valid image file', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                uploadedImages[viewType] = e.target.result;
                displayImagePreview(viewType, e.target.result);
            };
            reader.readAsDataURL(file);
        }

        function displayImagePreview(viewType, imageData) {
            const previewDiv = document.getElementById(`preview${viewType.charAt(0).toUpperCase() + viewType.slice(1)}`);
            previewDiv.innerHTML = `
                <div class="image-preview">
                    <img src="${imageData}" alt="${viewType}">
                    <button type="button" class="image-preview-remove" onclick="removeImage('${viewType}'); event.stopPropagation();">√ó</button>
                </div>
            `;
        }

        function removeImage(viewType) {
            uploadedImages[viewType] = null;
            document.getElementById(`image${viewType.charAt(0).toUpperCase() + viewType.slice(1)}`).value = '';
            document.getElementById(`preview${viewType.charAt(0).toUpperCase() + viewType.slice(1)}`).innerHTML = '';
        }

        function clearImagePreviews() {
            ['Front', 'Back', 'Side', 'Top'].forEach(view => {
                const previewDiv = document.getElementById(`preview${view}`);
                if (previewDiv) previewDiv.innerHTML = '';
            });
        }

        function saveProduct(event) {
            event.preventDefault();
            
            // Get selected sizes
            const sizes = Array.from(document.querySelectorAll('input[name="sizes"]:checked'))
                .map(cb => cb.value);
            
            const productData = {
                id: Date.now(),
                name: document.getElementById('productName').value,
                description: document.getElementById('productDescription').value,
                category: document.getElementById('productCategory').value,
                price: parseInt(document.getElementById('productPrice').value),
                originalPrice: parseInt(document.getElementById('productOriginalPrice').value) || 0,
                stock: parseInt(document.getElementById('productStock').value),
                imageFront: uploadedImages.front,
                imageBack: uploadedImages.back,
                imageSide: uploadedImages.side,
                imageTop: uploadedImages.top,
                sizes: sizes,
                rating: parseFloat(document.getElementById('productRating').value) || 4.5,
                createdAt: new Date().toISOString()
            };
            
            const index = document.getElementById('productIndex').value;
            if (index !== '') {
                appState.products[parseInt(index)] = productData;
                showToast('‚úÖ Product updated successfully!');
            } else {
                appState.products.push(productData);
                showToast('‚úÖ Product added successfully!');
            }
            
            // Save to Google Sheets
            saveProductToAPI(productData);
            
            closeProductModal();
            render();
        }

        function editProduct(index) {
            const product = appState.products[index];
            document.getElementById('productModal').classList.add('active');
            document.getElementById('modalTitle').textContent = 'Edit Product';
            document.getElementById('productName').value = product.name;
            document.getElementById('productDescription').value = product.description;
            document.getElementById('productCategory').value = product.category;
            document.getElementById('productPrice').value = product.price;
            document.getElementById('productOriginalPrice').value = product.originalPrice || '';
            document.getElementById('productStock').value = product.stock;
            document.getElementById('productRating').value = product.rating || 4.5;
            document.getElementById('productIndex').value = index;
            
            // Set sizes
            product.sizes?.forEach(size => {
                const checkbox = document.querySelector(`input[name="sizes"][value="${size}"]`);
                if (checkbox) checkbox.checked = true;
            });
            
            // Display existing images
            uploadedImages.front = product.imageFront;
            uploadedImages.back = product.imageBack;
            uploadedImages.side = product.imageSide;
            uploadedImages.top = product.imageTop;
            
            if (product.imageFront) displayImagePreview('front', product.imageFront);
            if (product.imageBack) displayImagePreview('back', product.imageBack);
            if (product.imageSide) displayImagePreview('side', product.imageSide);
            if (product.imageTop) displayImagePreview('top', product.imageTop);
        }

        function deleteProduct(index) {
            if (confirm('Are you sure you want to delete this product?')) {
                appState.products.splice(index, 1);
                showToast('Product deleted successfully', 'error');
                render();
            }
        }

        function updateStock(index) {
            const newStock = prompt('Enter new stock quantity:', appState.products[index].stock);
            if (newStock !== null && !isNaN(newStock)) {
                appState.products[index].stock = parseInt(newStock);
                showToast('‚úÖ Stock updated successfully!');
                render();
            }
        }

        // ============================================
        // ORDER MANAGEMENT
        // ============================================
        function updateOrderStatus(index, status) {
            appState.orders[index].status = status;
            showToast('‚úÖ Order status updated!');
            render();
        }

        function viewOrderDetails(index) {
            const order = appState.orders[index];
            alert(`Order Details:\n\nOrder ID: ${order.id}\nCustomer: ${order.customerName}\nEmail: ${order.customerEmail}\nTotal: ${formatCurrency(order.total)}\nStatus: ${order.status}`);
        }

        // ============================================
        // API INTEGRATION
        // ============================================
        async function testAPIConnection() {
            const resultDiv = document.getElementById('apiTestResult');
            resultDiv.innerHTML = 'üîÑ Testing connection...';
            
            if (CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID')) {
                resultDiv.innerHTML = '<p style="color: var(--color-red-500); font-size: 14px;">‚ùå API not configured. Please update YOUR_DEPLOYMENT_ID in the CONFIG object.</p>';
                return;
            }
            
            try {
                const response = await fetch(CONFIG.API_BASE_URL + '?action=test', {
                    method: 'GET',
                    mode: 'cors'
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '<p style="color: var(--color-green-500); font-size: 14px;">‚úÖ API connection successful!</p>';
                    showToast('‚úÖ API connected successfully!');
                } else {
                    resultDiv.innerHTML = '<p style="color: var(--color-orange-500); font-size: 14px;">‚ö†Ô∏è API responded but with error status</p>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: var(--color-red-500); font-size: 14px;">‚ùå Connection failed: ${error.message}</p>`;
                showToast('‚ùå API connection failed', 'error');
            }
        }
        
        async function loadProductsFromAPI() {
            if (CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID')) {
                console.warn('API not configured - using local data only');
                return;
            }
            
            try {
                const response = await fetch(CONFIG.API_BASE_URL + '?action=getProducts');
                if (response.ok) {
                    const data = await response.json();
                    if (data.products && data.products.length > 0) {
                        appState.products = data.products;
                        showToast('‚úÖ Products loaded from Google Sheets');
                    }
                }
            } catch (error) {
                console.error('Failed to load products:', error);
            }
        }
        
        async function saveProductToAPI(productData) {
            if (CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID')) {
                showToast('‚ö†Ô∏è API not configured - product saved locally only', 'error');
                return;
            }
            
            try {
                const response = await fetch(CONFIG.API_BASE_URL, {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        action: 'addProduct',
                        product: productData
                    })
                });
                
                if (response.ok) {
                    showToast('‚úÖ Product saved to Google Sheets!');
                } else {
                    showToast('‚ö†Ô∏è Product saved locally, but sync to Sheets failed', 'error');
                }
            } catch (error) {
                console.error('Failed to save product:', error);
                showToast('‚ö†Ô∏è Product saved locally only', 'error');
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        window.addEventListener('DOMContentLoaded', async () => {
            // Load sample data for demo
            appState.products = [
                {
                    id: 1,
                    name: "Premium Cotton T-Shirt",
                    description: "High-quality cotton t-shirt with superior comfort",
                    category: "T-Shirt",
                    price: 299000,
                    originalPrice: 399000,
                    stock: 25,
                    imageFront: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=300",
                    imageBack: null,
                    imageSide: null,
                    imageTop: null,
                    sizes: ["S", "M", "L", "XL"],
                    rating: 4.5
                },
                {
                    id: 2,
                    name: "Classic Denim Jacket",
                    description: "Timeless denim jacket for all seasons",
                    category: "Jacket",
                    price: 599000,
                    originalPrice: 799000,
                    stock: 15,
                    imageFront: "https://images.unsplash.com/photo-1551028719-00167b16eac5?w=300",
                    imageBack: null,
                    imageSide: null,
                    imageTop: null,
                    sizes: ["M", "L", "XL"],
                    rating: 4.8
                },
                {
                    id: 3,
                    name: "Sport Running Shoes",
                    description: "Lightweight running shoes for maximum performance",
                    category: "Shoes",
                    price: 899000,
                    originalPrice: 1199000,
                    stock: 8,
                    imageFront: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=300",
                    imageBack: null,
                    imageSide: null,
                    imageTop: null,
                    sizes: ["40", "41", "42", "43"],
                    rating: 4.7
                },
                {
                    id: 4,
                    name: "Casual Cotton Shirt",
                    description: "Perfect casual shirt for everyday wear",
                    category: "Shirt",
                    price: 349000,
                    originalPrice: 449000,
                    stock: 3,
                    imageFront: "https://images.unsplash.com/photo-1596755094514-f87e34085b2c?w=300",
                    imageBack: null,
                    imageSide: null,
                    imageTop: null,
                    sizes: ["S", "M", "L"],
                    rating: 4.3
                }
            ];
            
            appState.orders = [
                {
                    id: "ORD001",
                    customerName: "John Doe",
                    customerEmail: "john@example.com",
                    total: 299000,
                    items: [{ name: "Premium Cotton T-Shirt", quantity: 1 }],
                    status: "pending",
                    date: new Date().toISOString().split('T')[0]
                },
                {
                    id: "ORD002",
                    customerName: "Jane Smith",
                    customerEmail: "jane@example.com",
                    total: 599000,
                    items: [{ name: "Classic Denim Jacket", quantity: 1 }],
                    status: "processing",
                    date: new Date().toISOString().split('T')[0]
                },
                {
                    id: "ORD003",
                    customerName: "Mike Johnson",
                    customerEmail: "mike@example.com",
                    total: 1198000,
                    items: [{ name: "Sport Running Shoes", quantity: 1 }, { name: "Premium Cotton T-Shirt", quantity: 1 }],
                    status: "shipped",
                    date: new Date(Date.now() - 86400000).toISOString().split('T')[0]
                },
                {
                    id: "ORD004",
                    customerName: "Sarah Williams",
                    customerEmail: "sarah@example.com",
                    total: 698000,
                    items: [{ name: "Casual Cotton Shirt", quantity: 2 }],
                    status: "delivered",
                    date: new Date(Date.now() - 172800000).toISOString().split('T')[0]
                }
            ];
            
            render();
            
            // Try to load from API if configured
            if (!CONFIG.API_BASE_URL.includes('YOUR_DEPLOYMENT_ID')) {
                await loadProductsFromAPI();
                render();
            }
        });
    </script>
</body>
</html>
